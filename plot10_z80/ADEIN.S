	GLOBAL ADEIN,ADEOUT,KAS2A1,KAS2AM,KA12AS,KAM2AS
SYSTEM:	EQU 1403H
CONIN:	EQU	1
CONOUT:	EQU	2
WRITEB:	EQU	0EH	;WRITE BINARY
READL:	EQU	0CH	;READ LINE
;
;___________________________________________
ADEIN:
	;H[MTAR ADE ARRAY
	;  HL PEKAR P] ANTAL TECKEN
	;  DE PEKAR P] ADE ARRAY
	;
	PUSH IY
	PUSH HL
	PUSH DE
	LD C,(HL)
	INC HL
	LD B,(HL)
	LD DE,INBUFF
	LD IY,IYIBUF		;S[TT UPP IY-VEKTOR
	LD (IY),CONIN		;ENHET
	LD (IY+1),READL		;TYP AV \VERF\RING
	LD (IY+2),E		;BUFFER-ADRESS
	LD (IY+3),D
	LD (IY+4),C		;ANTAL TECKEN
	LD (IY+5),B
	XOR A			;NOLLST[LL RESTEN
	LD (IY+6),A
	LD (IY+7),A
	LD (IY+8),A
	LD (IY+9),A
	CALL SYSTEM		;STARTA \VERF\RING
	;
	LD HL,INBUFF		;SKALA BORT BLANKA
				;FRAM TILL <CR>
	LD C,(IY+4)
	LD B,(IY+5)
	ADD HL,BC		;ADRESS SISTA TECKEN
	DEC HL
STRIP1:	DEC HL
	DEC BC
	XOR A			;ANTAL TECKEN > 0 ?
	CP C
	JR Z,ENSTRP
	LD A,(HL)		;BLANKA ?
	AND 7FH			;SKALA AV PARITET
	CP ' '
	JR Z,STRIP1		;FORTS[TT TAG BORT
				;BLANKA
ENSTRP:
	POP DE			;STARTADRESS ADE ARRAY
	PUSH DE
	PUSH BC
	LD B,C			;ANTAL TECKEN
	LD HL,INBUFF
	CALL STRADE		;OMVANDLA TILL ADE ARRAY
	POP BC			;S[TT UTPARAMETRAR
	POP DE
	POP HL
	LD (HL),C
	INC HL
	LD (HL),B
	DEC HL
	POP IY
	RET
;__________________________________________
STRADE:
	;\VERS[TT STR[NG TILL ADE ARRAY
	;  HL PEKAR P] STR[NG
	;  DE PEKAR P] ADE ARRAY
	;  B ANGER ANTAL TECKEN  > 0 , < 256
	;
	XOR A			;KOLLA L[NGDEN > 0
	CP B
	RET Z
STRLOP:	LD A,(HL)		;FLYTTA STR[NGEN
	AND 7FH			;BORT MED PARITET
	LD (DE),A
	INC DE
	XOR A
	LD (DE),A		;NOLLST[LL H\GA DELEN
	INC DE
	INC HL
	DJNZ STRLOP		;LOOP TILLS ALLA TECKEN
				;\VERF\RDA
	RET
;_______________________________________________________
